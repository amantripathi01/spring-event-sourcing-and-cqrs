# ********RoostGPT********

# Test generated by RoostGPT for test amanMaxDepthTesting using AI Type Open AI and AI Model gpt-4
# 
# ================================VULNERABILITIES================================
# Vulnerability: CWE-209: Information Exposure Through an Error Message
# Issue: The error message in the log reveals that the system has a route that doesn't match any method. This could potentially expose system details to an attacker. The issue is found in the line: '[HTTP SERVER] get /authorizations âœ–  error     Request terminated with error: https://stoplight.io/prism/errors#NO_METHOD_MATCHED_ERROR: Route resolved, but no method matched'
# Solution: Avoid exposing system details through error messages. Instead, use custom error pages or messages, and log the detailed error internally for debugging.
# 
# Vulnerability: CWE-200: Exposure of Sensitive Information to an Unauthorized Actor
# Issue: The log shows the usage of an API token in the header which could be a potential security risk if the logs are not properly secured or if they are leaked. The issue is found in the line: 'header':  {'accept':'application/json','token':'{{apiKey}}'...
# Solution: Avoid logging sensitive information such as API keys. If it's necessary to log such details for debugging, ensure logs are properly secured and access is strictly controlled.
# 
# Vulnerability: CWE-213: Intentional Information Disclosure
# Issue: The log reveals the software version of the user agent, which can be exploited if there are known vulnerabilities in that version. The issue is found in the line: 'user-agent':'PostmanRuntime/7.32.3'...
# Solution: Avoid logging software versions or other system details that could potentially be exploited. If it's necessary to log such details for debugging, ensure logs are properly secured and access is strictly controlled.
# 
# ================================================================================
# Test generated for /authorizations_get for http method type GET in artillery framework
# RoostTestHash=7cdf3c47c1
# 
# 

# ********RoostGPT********
config:
  target: "{{ $processEnvironment.API_HOST }}"
  phases:
    - duration: 60
      arrivalRate: 5
  payload:
    path: "authorizations_get_success.csv"
    fields: ["id", "name", "email", "createdAt", "updatedAt"]
    skipHeader: true
    delimiter: "^|^"
  plugins:
    expect: {}
    
scenarios:
  - name: "List accounts who have access to my account"
    flow:
      - log: "Starting test for /authorizations endpoint"
      - get:
          url: "/authorizations?name={{ name }}"
          headers:
            Token: "{{$processEnvironment.AUTH_TOKEN}}"
            Accept: "application/json"
          expect:
            - statusCode: 200
            - hasProperty: "total"
            - hasProperty: "authorizations"
      - hasProperty: ["authorizations", "id"]
      - hasProperty: ["authorizations", "name"]
      - hasProperty: ["authorizations", "email"]
      - hasProperty: ["authorizations", "createdAt"]
      - hasProperty: ["authorizations", "updatedAt"]
      - hasHeader: "api-version"
      - think: 1
